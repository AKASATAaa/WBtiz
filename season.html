<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>시즌 정보 - WBD 기록실</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
        }
        
        .header {
            background-color: white;
            border-bottom: 1px solid #e9ecef;
            padding: 0;
        }
        
        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: inherit;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #ff4757, #ff3742);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: #333;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .language-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .language-btn {
            padding: 6px 12px;
            border: 1px solid #e9ecef;
            background-color: white;
            color: #666;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .language-btn:hover {
            border-color: #ff4757;
            color: #ff4757;
        }
        
        .language-btn.active {
            background-color: #ff4757;
            color: white;
            border-color: #ff4757;
        }
        
        .search-icon, .user-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .search-icon svg, .user-icon svg {
            width: 20px;
            height: 20px;
            fill: #666;
        }
        
        .user-icon {
            background-color: #ff4757;
            border-radius: 50%;
        }
        
        .user-icon svg {
            fill: white;
        }
        
        .nav-container {
            background-color: white;
            border-bottom: 1px solid #e9ecef;
        }
        
        .nav {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            padding: 0 20px;
        }
        
        .nav-item {
            padding: 16px 20px;
            color: #666;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .nav-item:hover {
            color: #333;
            border-bottom-color: #ff4757;
        }
        
        .nav-item.active {
            color: #333;
            border-bottom-color: #ff4757;
        }

        .main-content {
            background-color: #f8f9fa;
            min-height: 100vh;
            padding: 20px 0;
        }

        .content-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .league-selector {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .league-selector h2 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .league-dropdown {
            width: 100%;
            max-width: 300px;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
            background-color: white;
            cursor: pointer;
        }

        .league-dropdown:focus {
            outline: none;
            border-color: #ff4757;
            box-shadow: 0 0 0 2px rgba(255, 71, 87, 0.1);
        }

        .selected-league-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .selected-league-info.show {
            display: block;
        }

        .selected-league-info h3 {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            text-align: center;
            margin: 0;
        }

        .league-badge {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
        }

        .league-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #ff4757;
        }

        .detail-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 14px;
            color: #333;
            font-weight: 600;
        }

        .no-league-selected {
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .mvp-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .mvp-section.show {
            display: block;
        }

        .mvp-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mvp-badge {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .league-record-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .league-record-section.show {
            display: block;
        }

        .league-record-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .record-badge {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .record-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .record-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .record-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #4CAF50;
        }

        .record-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4CAF50, #45a049, #4CAF50);
        }

        /* 투수 카드 스타일 */
        .record-card.pitcher::before {
            background: linear-gradient(90deg, #2196F3, #1976D2, #2196F3);
        }

        .record-card.pitcher:hover {
            border-color: #2196F3;
        }

        /* 타자 카드 스타일 */
        .record-card.batter::before {
            background: linear-gradient(90deg, #FF9800, #F57C00, #FF9800);
        }

        .record-card.batter:hover {
            border-color: #FF9800;
        }

        /* 팀 카드 스타일 */
        .record-card.team::before {
            background: linear-gradient(90deg, #9C27B0, #7B1FA2, #9C27B0);
        }

        .record-card.team:hover {
            border-color: #9C27B0;
        }

        .record-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            text-align: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }

        .record-details {
            text-align: center;
        }

        .nickname {
            font-size: 20px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* 투수 닉네임 색상 */
        .record-card.pitcher .nickname {
            color: #2196F3;
        }

        /* 타자 닉네임 색상 */
        .record-card.batter .nickname {
            color: #FF9800;
        }

        /* 팀 닉네임 색상 */
        .record-card.team .nickname {
            color: #9C27B0;
        }

        .date-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
            background: #f8f9fa;
            padding: 6px 12px;
            border-radius: 16px;
            display: inline-block;
        }

        .note-info {
            font-size: 13px;
            color: #888;
            font-style: italic;
            background: #f0f0f0;
            padding: 8px 12px;
            border-radius: 8px;
            display: inline-block;
            max-width: 90%;
            line-height: 1.3;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 8px 6px;
            background: white;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 2px;
        }

        .stat-label {
            font-size: 10px;
            color: #666;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .win-loss {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 12px;
            padding: 10px;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }

        .win, .loss {
            text-align: center;
        }

        .win .stat-value {
            color: #4CAF50;
        }

        .loss .stat-value {
            color: #ff4757;
        }

        .win-rate {
            text-align: center;
            padding: 8px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 6px;
            margin-top: 12px;
        }

        .win-rate .stat-value {
            color: white;
            font-size: 18px;
        }

        .win-rate .stat-label {
            color: rgba(255,255,255,0.9);
        }

        .rank-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: 700;
            font-size: 12px;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .title-holder-cards {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 20px;
        }

        .mvp-special-card {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border: 2px solid #ffb300;
            border-radius: 16px;
            padding: 32px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
            text-align: center;
            margin-bottom: 8px;
        }

        .mvp-special-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(255, 215, 0, 0.4);
            border-color: #ff9500;
        }

        .mvp-special-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #ff9500, #ffb300, #ff9500);
        }

        .mvp-special-label {
            font-size: 12px;
            font-weight: 700;
            color: #b8860b;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 25px;
            display: inline-block;
        }

        .mvp-special-name {
            font-size: 32px;
            font-weight: 800;
            color: #8b4513;
            margin-bottom: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .mvp-special-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #b8860b;
            font-size: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .regular-title-holder-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .outstanding-card {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
            border-radius: 14px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(33, 150, 243, 0.2);
            text-align: center;
            margin-bottom: 8px;
        }

        .outstanding-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(33, 150, 243, 0.3);
            border-color: #1976d2;
        }

        .outstanding-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #1976d2, #2196f3, #1976d2);
        }

        .outstanding-label {
            font-size: 11px;
            font-weight: 700;
            color: #1565c0;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .outstanding-name {
            font-size: 22px;
            font-weight: 700;
            color: #0d47a1;
            margin-bottom: 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .outstanding-icon {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1565c0;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .title-holder-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .title-holder-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #ffd700;
        }

        .title-holder-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffed4e, #ffd700);
        }

        .title-holder-category {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            background: #f8f9fa;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .title-holder-name {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 0;
            text-align: center;
            padding: 12px 0;
        }

        .title-holder-icon {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .content-placeholder {
            background: white;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            color: #666;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .content-container {
                padding: 0 12px;
            }
            
            .record-cards {
                grid-template-columns: 1fr;
            }
            
            .title-holder-cards {
                gap: 12px;
            }
            
            .mvp-special-card {
                padding: 24px;
            }
            
            .mvp-special-name {
                font-size: 24px;
            }
            
            .mvp-special-icon {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }
            
            .outstanding-card {
                padding: 20px;
            }
            
            .outstanding-name {
                font-size: 20px;
            }
            
            .outstanding-icon {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
            
            .regular-title-holder-cards {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .title-holder-card {
                padding: 16px;
            }
            
            .title-holder-name {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <a href="/" class="logo">
                <div class="logo-icon">W</div>
                <span class="logo-text">WBD 기록실</span>
            </a>
            <div class="header-actions">
                <div class="language-selector">
                    <button class="language-btn active" data-lang="ko">한국어</button>
                    <button class="language-btn" data-lang="ja">日本語</button>
                </div>
            </div>
        </div>
    </header>
    
    <nav class="nav-container">
        <div class="nav">
            <a href="record_bat_basic.html" class="nav-item">기록실</a>
            <a href="season.html" class="nav-item active">시즌정보</a>
            <a href="team.html" class="nav-item">팀정보</a>
            <a href="player.html" class="nav-item">선수정보</a>
            <a href="schedule.html" class="nav-item">경기일정</a>


        </div>
    </nav>

    <main class="main-content">
        <div class="content-container">
            <h1 class="page-title">시즌 기록</h1>
            <div class="league-selector">
                <h2>리그 선택</h2>
                <select class="league-dropdown" id="leagueDropdown">
                    <option value="">리그를 선택하세요</option>
                </select>
            </div>
            <div class="selected-league-info" id="selectedLeagueInfo">
                <h3>
                    <span class="league-badge" id="selectedLeagueBadge"></span>
                </h3>
            </div>
            <div class="mvp-section" id="mvpSection">
                <h3>
                    <span class="mvp-badge">타이틀 홀더</span>
                </h3>
                <div class="title-holder-cards">
                    <!-- 타이틀 홀더 데이터가 여기에 동적으로 채워집니다 -->
                </div>
            </div>
            <div class="league-record-section" id="leagueRecordSection">
                <h3>
                    <span class="record-badge">리그 기록</span>
                </h3>
                <div class="record-cards">
                    <!-- 리그 기록 데이터가 여기에 동적으로 채워집니다 -->
                </div>
            </div>
            <div class="content-placeholder">
                시즌 정보 페이지 내용이 여기에 표시됩니다.
            </div>
        </div>
    </main>

    <script>
        // Excel 파일에서 리그 정보를 읽어오는 함수
        async function loadLeagueData() {
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                // '리그분류' 시트 읽기
                const sheetName = '리그분류';
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    // 첫 번째 행을 헤더로 사용
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);
                    
                    // "League Name" 컬럼 찾기
                    const leagueNameColumnIndex = headers.findIndex(header => 
                        header && header.toString().toLowerCase().includes('league name')
                    );
                    
                    // "isdef" 컬럼 찾기
                    const isdefColumnIndex = headers.findIndex(header => 
                        header && header.toString().toLowerCase().includes('isdef')
                    );
                    
                    if (leagueNameColumnIndex !== -1) {
                        // League Name 컬럼 아래의 리그명들 추출 (원본 순서 유지)
                        const leagues = data.map(row => row[leagueNameColumnIndex]).filter(Boolean);
                        
                        // 드롭다운 업데이트
                        updateLeagueDropdown(leagues);
                        
                        // 전체 데이터를 전역 변수에 저장 (선택 시 사용)
                        window.leagueData = { headers, data, leagueNameColumnIndex, isdefColumnIndex };
                        
                        // isdef가 true인 리그를 찾아서 기본 선택
                        if (isdefColumnIndex !== -1) {
                            const defaultLeagueRow = data.find(row => 
                                row[isdefColumnIndex] && 
                                row[isdefColumnIndex].toString().toLowerCase() === 'true'
                            );
                            
                            if (defaultLeagueRow) {
                                const defaultLeague = defaultLeagueRow[leagueNameColumnIndex];
                                if (defaultLeague) {
                                    // 드롭다운에서 기본 리그 선택
                                    const dropdown = document.getElementById('leagueDropdown');
                                    dropdown.value = defaultLeague;
                                    
                                    // 기본 리그 정보 표시
                                    displayLeagueInfo(defaultLeague);
                                    document.getElementById('selectedLeagueInfo').classList.add('show');
                                    
                                    // 기본 리그의 수훈선수와 기록 데이터 로드
                                    loadMVPData(defaultLeague);
                                    loadLeagueRecordData(defaultLeague);
                                }
                            }
                        }
                        
                        console.log('League Name 컬럼 인덱스:', leagueNameColumnIndex);
                        console.log('isdef 컬럼 인덱스:', isdefColumnIndex);
                        console.log('로드된 리그:', leagues);
                        console.log('전체 리그 데이터:', window.leagueData);
                    } else {
                        console.error('League Name 컬럼을 찾을 수 없습니다.');
                        updateLeagueDropdown([]);
                    }
                } else {
                    console.error('리그분류 시트를 찾을 수 없습니다.');
                    updateLeagueDropdown([]);
                }
            } catch (error) {
                console.error('Excel 파일을 읽는 중 오류 발생:', error);
                updateLeagueDropdown([]);
            }
        }

        // 리그 드롭다운 업데이트 함수
        function updateLeagueDropdown(leagues) {
            const dropdown = document.getElementById('leagueDropdown');
            dropdown.innerHTML = '<option value="">리그를 선택하세요</option>';
            
            leagues.forEach(league => {
                const option = document.createElement('option');
                option.value = league;
                option.textContent = league;
                dropdown.appendChild(option);
            });

            // 드롭다운 변경 이벤트 리스너 추가
            dropdown.addEventListener('change', handleLeagueSelection);
        }

        // 리그 선택 처리 함수
        function handleLeagueSelection(event) {
            const selectedLeague = event.target.value;
            const leagueInfo = document.getElementById('selectedLeagueInfo');
            
            if (!selectedLeague) {
                leagueInfo.classList.remove('show');
                // 리그가 선택되지 않았을 때는 수훈선수와 기록 섹션도 숨김
                document.getElementById('mvpSection').classList.remove('show');
                document.getElementById('leagueRecordSection').classList.remove('show');
                return;
            }

            // 선택된 리그 정보 표시
            displayLeagueInfo(selectedLeague);
            leagueInfo.classList.add('show');
            
            // 선택된 리그의 수훈선수와 기록 데이터 로드
            loadMVPData(selectedLeague);
            loadLeagueRecordData(selectedLeague);
        }

        // 리그 정보 표시 함수
        function displayLeagueInfo(leagueName) {
            // 리그 배지 업데이트
            const badge = document.getElementById('selectedLeagueBadge');
            badge.textContent = leagueName;
            
            // Excel 데이터에서 해당 리그 정보 찾기
            if (window.leagueData && window.leagueData.data) {
                const leagueRow = window.leagueData.data.find(row => row[window.leagueData.leagueNameColumnIndex] === leagueName);
                if (leagueRow) {
                    // 헤더와 데이터 매칭하여 정보 표시
                    const headers = window.leagueData.headers;
                    const data = leagueRow;
                    
                    // 각 컬럼의 정보를 표시 (헤더가 있는 경우)
                    if (headers && headers.length > 1) {
                        for (let i = 1; i < Math.min(headers.length, 5); i++) {
                            const header = headers[i];
                            const value = data[i] || '정보 없음';
                            
                            // 해당하는 detail-value 요소 찾아서 업데이트
                            const detailElements = document.querySelectorAll('.detail-value');
                            if (detailElements[i]) {
                                detailElements[i].textContent = value;
                            }
                        }
                    }
                }
            }
        }

        // MVP 데이터 로드 및 표시 함수
        async function loadMVPData(leagueName) {
            if (!leagueName) return;
            
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                const sheetName = `${leagueName} 수훈`; // 선택된 리그명 + "수훈"
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);

                    // 타이틀 홀더가 있는지 확인
                    if (data.length > 0 && data.some(row => row.some(cell => cell))) {
                        const titleHolderCards = document.querySelector('#mvpSection .title-holder-cards');
                        titleHolderCards.innerHTML = ''; // 카드 컨테이너 내용 초기화

                        let mvpFound = false;
                        const outstandingCards = [];
                        const regularCards = [];

                        // 부문과 이름 구조로 데이터 처리
                        data.forEach((row, rowIndex) => {
                            if (row && row.length >= 2 && (row[0] || row[1])) { // 부문과 이름이 있는 행만
                                const category = row[0] || '';
                                const name = row[1] || '정보 없음';
                                
                                // MVP 부문 확인 (대소문자 구분 없이)
                                if (category.toString().toLowerCase().includes('mvp')) {
                                    
                                    // MVP 특별 카드 생성
                                    const mvpCard = document.createElement('div');
                                    mvpCard.classList.add('mvp-special-card');
                                    mvpCard.innerHTML = `
                                        <div class="mvp-special-icon">👑</div>
                                        <div class="mvp-special-label">MVP</div>
                                        <div class="mvp-special-name">${name}</div>
                                    `;
                                    titleHolderCards.appendChild(mvpCard);
                                    mvpFound = true;
                                } else if (category.toString().toLowerCase().includes('최우수')) {
                                    // 최우수 부문 카드 정보 저장
                                    outstandingCards.push({ category, name });
                                } else {
                                    // 일반 타이틀 홀더 카드 정보 저장
                                    regularCards.push({ category, name });
                                }
                            }
                        });

                        // 최우수 부문 카드들을 MVP 아래에 표시
                        if (outstandingCards.length > 0) {
                            outstandingCards.forEach(({ category, name }) => {
                                const card = document.createElement('div');
                                card.classList.add('outstanding-card');
                                
                                // 부문에 따른 아이콘 설정
                                let iconText = '⭐';
                                
                                if (category.toString().toLowerCase().includes('타')) {
                                    iconText = '⚾';
                                } else if (category.toString().toLowerCase().includes('투')) {
                                    iconText = '🎯';
                                }

                                card.innerHTML = `
                                    <div class="outstanding-icon">${iconText}</div>
                                    <div class="outstanding-label">${category}</div>
                                    <div class="outstanding-name">${name}</div>
                                `;
                                
                                titleHolderCards.appendChild(card);
                            });
                        }

                        // 일반 타이틀 홀더 카드들을 그리드로 표시
                        if (regularCards.length > 0) {
                            const regularCardsContainer = document.createElement('div');
                            regularCardsContainer.classList.add('regular-title-holder-cards');
                            
                            regularCards.forEach(({ category, name }) => {
                                const card = document.createElement('div');
                                card.classList.add('title-holder-card');
                                
                                // 부문에 따른 아이콘 설정
                                let iconText = '🏆';
                                
                                if (category.toString().toLowerCase().includes('타')) {
                                    iconText = '⚾';
                                } else if (category.toString().toLowerCase().includes('투')) {
                                    iconText = '🎯';
                                } else if (category.toString().toLowerCase().includes('팀')) {
                                    iconText = '🏅';
                                } else if (category.toString().toLowerCase().includes('수비')) {
                                    iconText = '🛡️';
                                } else if (category.toString().toLowerCase().includes('주루')) {
                                    iconText = '🏃';
                                }

                                card.innerHTML = `
                                    <div class="title-holder-icon">${iconText}</div>
                                    <div class="title-holder-category">${category}</div>
                                    <div class="title-holder-name">${name}</div>
                                `;
                                
                                regularCardsContainer.appendChild(card);
                            });
                            
                            titleHolderCards.appendChild(regularCardsContainer);
                        }

                        document.getElementById('mvpSection').classList.add('show');
                    } else {
                        // 타이틀 홀더가 없으면 표시하지 않음
                        document.getElementById('mvpSection').classList.remove('show');
                    }
                } else {
                    console.error(`${sheetName} 시트를 찾을 수 없습니다.`);
                    document.getElementById('mvpSection').classList.remove('show');
                }
            } catch (error) {
                console.error('MVP 데이터를 읽는 중 오류 발생:', error);
                document.getElementById('mvpSection').classList.remove('show');
            }
        }

        // 리그 기록 데이터 로드 및 표시 함수
        async function loadLeagueRecordData(leagueName) {
            if (!leagueName) return;
            
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                const sheetName = `${leagueName} 기록`; // 선택된 리그명 + "기록"
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);

                    const recordCardsContainer = document.querySelector('#leagueRecordSection .record-cards');
                    recordCardsContainer.innerHTML = ''; // 카드 컨테이너 내용 초기화

                    if (data.length > 0) {
                        data.forEach((row, index) => {
                            if (row.some(cell => cell)) { // 빈 행이 아닌 경우만
                                const recordCard = document.createElement('div');
                                recordCard.classList.add('record-card');
                                
                                // 구분 컬럼 확인 (4번째 컬럼이 구분이라고 가정)
                                const category = row[4] || '';
                                let categoryClass = '';
                                
                                if (category.toString().toLowerCase().includes('투')) {
                                    categoryClass = 'pitcher';
                                } else if (category.toString().toLowerCase().includes('타')) {
                                    categoryClass = 'batter';
                                } else if (category.toString().toLowerCase().includes('팀')) {
                                    categoryClass = 'team';
                                }
                                
                                if (categoryClass) {
                                    recordCard.classList.add(categoryClass);
                                }
                                
                                recordCard.innerHTML = `
                                    <div class="record-title">${row[0] || 'N/A'}</div>
                                    <div class="record-details">
                                        <div class="date-info">${row[1] || 'N/A'}</div>
                                        <div class="nickname">${row[2] || 'N/A'}</div>
                                        <div class="note-info">${row[3] || 'N/A'}</div>
                                    </div>
                                `;
                                recordCardsContainer.appendChild(recordCard);
                            }
                        });
                        
                        document.getElementById('leagueRecordSection').classList.add('show');
                    } else {
                        document.getElementById('leagueRecordSection').classList.remove('show');
                    }
                } else {
                    console.error(`${sheetName} 시트를 찾을 수 없습니다.`);
                    document.getElementById('leagueRecordSection').classList.remove('show');
                }
            } catch (error) {
                console.error('리그 기록 데이터를 읽는 중 오류 발생:', error);
                document.getElementById('leagueRecordSection').classList.remove('show');
            }
        }

        // 언어 변경 기능
        document.addEventListener('DOMContentLoaded', function() {
            // 기존 함수 호출
            loadLeagueData();
            
            // 언어 변경 버튼 이벤트 리스너
            const languageBtns = document.querySelectorAll('.language-btn');
            
            languageBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const selectedLang = this.getAttribute('data-lang');
                    
                    // 활성 버튼 상태 변경
                    languageBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // 언어 변경 처리
                    changeLanguage(selectedLang);
                });
            });
            
            // 저장된 언어 설정 복원
            const savedLang = localStorage.getItem('selectedLanguage') || 'ko';
            const languageBtn = document.querySelector(`[data-lang="${savedLang}"]`);
            if (languageBtn) {
                languageBtn.click();
            }
        });

        // 언어 변경 함수
        function changeLanguage(lang) {
            const translations = {
                ko: {
                    title: '시즌 정보 - WBD 기록실',
                    logoText: 'WBD 기록실',
                    recordRoom: '기록실',
                    seasonInfo: '시즌정보',
                    teamInfo: '팀정보',
                    playerInfo: '선수정보',
                    schedule: '경기일정',
                    pageTitle: '시즌 기록',
                    leagueSelector: '리그 선택',
                    leagueSelectPlaceholder: '리그를 선택하세요',
                    mvpSection: '타이틀 홀더',
                    leagueRecordSection: '리그 기록',
                    category: '부문',
                    name: '이름',
                    contentPlaceholder: '시즌 정보 페이지 내용이 여기에 표시됩니다.'
                },
                ja: {
                    title: 'シーズン情報 - WBD 記録室',
                    logoText: 'WBD 記録室',
                    recordRoom: '記録室',
                    seasonInfo: 'シーズン情報',
                    teamInfo: 'チーム情報',
                    playerInfo: '選手情報',
                    schedule: '試合日程',
                    pageTitle: 'シーズン記録',
                    leagueSelector: 'リーグ選択',
                    leagueSelectPlaceholder: 'リーグを選択してください',
                    mvpSection: 'タイトルホルダー',
                    leagueRecordSection: 'リーグ記録',
                    category: '部門',
                    name: '名前',
                    contentPlaceholder: 'シーズン情報ページの内容がここに表示されます。'
                }
            };

            // 제목 변경
            document.title = translations[lang].title;
            document.querySelector('.logo-text').textContent = translations[lang].logoText;

            // 네비게이션 메뉴 변경
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach((item, index) => {
                if (index === 0) item.textContent = translations[lang].recordRoom;
                else if (index === 1) item.textContent = translations[lang].seasonInfo;
                else if (index === 2) item.textContent = translations[lang].teamInfo;
                else if (index === 3) item.textContent = translations[lang].playerInfo;
                else if (index === 4) item.textContent = translations[lang].schedule;
            });

            // 페이지 제목 변경
            document.querySelector('.page-title').textContent = translations[lang].pageTitle;

            // 리그 선택 섹션 변경
            document.querySelector('.league-selector h2').textContent = translations[lang].leagueSelector;
            document.querySelector('#leagueDropdown option[value=""]').textContent = translations[lang].leagueSelectPlaceholder;

            // MVP 섹션 변경
            document.querySelector('.mvp-badge').textContent = translations[lang].mvpSection;

            // 리그 기록 섹션 변경
            document.querySelector('.record-badge').textContent = translations[lang].leagueRecordSection;

            // 타이틀 홀더 카드 업데이트 (언어 변경 시 필요시 구현)

            // 콘텐츠 플레이스홀더 변경
            const contentPlaceholder = document.querySelector('.content-placeholder');
            if (contentPlaceholder) {
                contentPlaceholder.textContent = translations[lang].contentPlaceholder;
            }

            // 로컬 스토리지에 언어 설정 저장
            localStorage.setItem('selectedLanguage', lang);
        }
    </script>
</body>
</html>