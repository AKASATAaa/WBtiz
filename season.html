<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏãúÏ¶å Ï†ïÎ≥¥ - WBD Í∏∞Î°ùÏã§</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background-color: #f8f9fa;
        }
        
        .header {
            background-color: white;
            border-bottom: 1px solid #e9ecef;
            padding: 0;
        }
        
        .header-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 20px;
        }
        
        .logo {
            display: flex;
            align-items: center;
            text-decoration: none;
            color: inherit;
        }
        
        .logo-icon {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #ff4757, #ff3742);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 8px;
            color: white;
            font-weight: bold;
            font-size: 14px;
        }
        
        .logo-text {
            font-size: 18px;
            font-weight: 700;
            color: #333;
        }
        
        .header-actions {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .language-selector {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .language-btn {
            padding: 6px 12px;
            border: 1px solid #e9ecef;
            background-color: white;
            color: #666;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 500;
            transition: all 0.2s ease;
        }
        
        .language-btn:hover {
            border-color: #ff4757;
            color: #ff4757;
        }
        
        .language-btn.active {
            background-color: #ff4757;
            color: white;
            border-color: #ff4757;
        }
        
        .search-icon, .user-icon {
            width: 24px;
            height: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .search-icon svg, .user-icon svg {
            width: 20px;
            height: 20px;
            fill: #666;
        }
        
        .user-icon {
            background-color: #ff4757;
            border-radius: 50%;
        }
        
        .user-icon svg {
            fill: white;
        }
        
        .nav-container {
            background-color: white;
            border-bottom: 1px solid #e9ecef;
        }
        
        .nav {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            padding: 0 20px;
        }
        
        .nav-item {
            padding: 16px 20px;
            color: #666;
            text-decoration: none;
            font-size: 14px;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
        
        .nav-item:hover {
            color: #333;
            border-bottom-color: #ff4757;
        }
        
        .nav-item.active {
            color: #333;
            border-bottom-color: #ff4757;
        }

        .main-content {
            background-color: #f8f9fa;
            min-height: 100vh;
            padding: 20px 0;
        }

        .content-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            margin-bottom: 20px;
        }

        .league-selector {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .league-selector h2 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
        }

        .league-dropdown {
            width: 100%;
            max-width: 300px;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            color: #333;
            background-color: white;
            cursor: pointer;
        }

        .league-dropdown:focus {
            outline: none;
            border-color: #ff4757;
            box-shadow: 0 0 0 2px rgba(255, 71, 87, 0.1);
        }

        .selected-league-info {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .selected-league-info.show {
            display: block;
        }

        .selected-league-info h3 {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            text-align: center;
            margin: 0;
        }

        .league-badge {
            background: linear-gradient(135deg, #ff4757, #ff3742);
            color: white;
            padding: 8px 20px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
        }

        .league-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .detail-item {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 6px;
            border-left: 3px solid #ff4757;
        }

        .detail-label {
            font-size: 12px;
            color: #666;
            font-weight: 500;
            margin-bottom: 4px;
        }

        .detail-value {
            font-size: 14px;
            color: #333;
            font-weight: 600;
        }

        .no-league-selected {
            text-align: center;
            color: #999;
            font-style: italic;
        }

        .mvp-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .mvp-section.show {
            display: block;
        }

        .mvp-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mvp-badge {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #333;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .league-record-section {
            background: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: none;
        }

        .league-record-section.show {
            display: block;
        }

        .league-record-section h3 {
            font-size: 18px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .record-badge {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .record-cards {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-top: 16px;
        }

        .record-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 16px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .record-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #4CAF50;
        }

        .record-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #4CAF50, #45a049, #4CAF50);
        }

        /* Ìà¨Ïàò Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        .record-card.pitcher::before {
            background: linear-gradient(90deg, #2196F3, #1976D2, #2196F3);
        }

        .record-card.pitcher:hover {
            border-color: #2196F3;
        }

        /* ÌÉÄÏûê Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        .record-card.batter::before {
            background: linear-gradient(90deg, #FF9800, #F57C00, #FF9800);
        }

        .record-card.batter:hover {
            border-color: #FF9800;
        }

        /* ÌåÄ Ïπ¥Îìú Ïä§ÌÉÄÏùº */
        .record-card.team::before {
            background: linear-gradient(90deg, #9C27B0, #7B1FA2, #9C27B0);
        }

        .record-card.team:hover {
            border-color: #9C27B0;
        }

        .record-title {
            font-size: 16px;
            font-weight: 700;
            color: #333;
            text-align: center;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0f0f0;
        }

        .record-details {
            text-align: center;
        }

        .nickname {
            font-size: 20px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 10px;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* Ìà¨Ïàò ÎãâÎÑ§ÏûÑ ÏÉâÏÉÅ */
        .record-card.pitcher .nickname {
            color: #2196F3;
        }

        /* ÌÉÄÏûê ÎãâÎÑ§ÏûÑ ÏÉâÏÉÅ */
        .record-card.batter .nickname {
            color: #FF9800;
        }

        /* ÌåÄ ÎãâÎÑ§ÏûÑ ÏÉâÏÉÅ */
        .record-card.team .nickname {
            color: #9C27B0;
        }

        .date-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 500;
            background: #f8f9fa;
            padding: 6px 12px;
            border-radius: 16px;
            display: inline-block;
        }

        .note-info {
            font-size: 13px;
            color: #888;
            font-style: italic;
            background: #f0f0f0;
            padding: 8px 12px;
            border-radius: 8px;
            display: inline-block;
            max-width: 90%;
            line-height: 1.3;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 12px;
        }

        .stat-item {
            text-align: center;
            padding: 8px 6px;
            background: white;
            border-radius: 6px;
            border: 1px solid #f0f0f0;
        }

        .stat-value {
            font-size: 16px;
            font-weight: 700;
            color: #4CAF50;
            margin-bottom: 2px;
        }

        .stat-label {
            font-size: 10px;
            color: #666;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .win-loss {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 12px;
            padding: 10px;
            background: linear-gradient(135deg, #f8f9fa, #ffffff);
            border-radius: 6px;
            border: 1px solid #e9ecef;
        }

        .win, .loss {
            text-align: center;
        }

        .win .stat-value {
            color: #4CAF50;
        }

        .loss .stat-value {
            color: #ff4757;
        }

        .win-rate {
            text-align: center;
            padding: 8px;
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            border-radius: 6px;
            margin-top: 12px;
        }

        .win-rate .stat-value {
            color: white;
            font-size: 18px;
        }

        .win-rate .stat-label {
            color: rgba(255,255,255,0.9);
        }

        .rank-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: 700;
            font-size: 12px;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .title-holder-cards {
            display: flex;
            flex-direction: column;
            gap: 16px;
            margin-top: 20px;
        }

        .mvp-special-card {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            border: 2px solid #ffb300;
            border-radius: 16px;
            padding: 32px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
            text-align: center;
            margin-bottom: 8px;
        }

        .mvp-special-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 40px rgba(255, 215, 0, 0.4);
            border-color: #ff9500;
        }

        .mvp-special-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #ff9500, #ffb300, #ff9500);
        }

        .mvp-special-label {
            font-size: 12px;
            font-weight: 700;
            color: #b8860b;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 25px;
            display: inline-block;
        }

        .mvp-special-name {
            font-size: 32px;
            font-weight: 800;
            color: #8b4513;
            margin-bottom: 0;
            text-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .mvp-special-icon {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 48px;
            height: 48px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #b8860b;
            font-size: 24px;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .regular-title-holder-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 16px;
        }

        .outstanding-card {
            background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
            border: 2px solid #2196f3;
            border-radius: 14px;
            padding: 24px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(33, 150, 243, 0.2);
            text-align: center;
            margin-bottom: 8px;
        }

        .outstanding-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(33, 150, 243, 0.3);
            border-color: #1976d2;
        }

        .outstanding-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #1976d2, #2196f3, #1976d2);
        }

        .outstanding-label {
            font-size: 11px;
            font-weight: 700;
            color: #1565c0;
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 6px;
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .outstanding-name {
            font-size: 22px;
            font-weight: 700;
            color: #0d47a1;
            margin-bottom: 0;
            text-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        .outstanding-icon {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 36px;
            height: 36px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #1565c0;
            font-size: 18px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .title-holder-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border: 1px solid #e9ecef;
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }

        .title-holder-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            border-color: #ffd700;
        }

        .title-holder-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ffd700, #ffed4e, #ffd700);
        }

        .title-holder-category {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
            background: #f8f9fa;
            padding: 6px 12px;
            border-radius: 20px;
            display: inline-block;
        }

        .title-holder-name {
            font-size: 20px;
            font-weight: 700;
            color: #333;
            margin-bottom: 0;
            text-align: center;
            padding: 12px 0;
        }

        .title-holder-icon {
            position: absolute;
            top: 16px;
            right: 16px;
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #333;
            font-weight: 700;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
        }

        .content-placeholder {
            background: white;
            border-radius: 8px;
            padding: 40px;
            text-align: center;
            color: #666;
            font-size: 16px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        @media (max-width: 768px) {
            .content-container {
                padding: 0 12px;
            }
            
            .record-cards {
                grid-template-columns: 1fr;
            }
            
            .title-holder-cards {
                gap: 12px;
            }
            
            .mvp-special-card {
                padding: 24px;
            }
            
            .mvp-special-name {
                font-size: 24px;
            }
            
            .mvp-special-icon {
                width: 36px;
                height: 36px;
                font-size: 18px;
            }
            
            .outstanding-card {
                padding: 20px;
            }
            
            .outstanding-name {
                font-size: 20px;
            }
            
            .outstanding-icon {
                width: 32px;
                height: 32px;
                font-size: 16px;
            }
            
            .regular-title-holder-cards {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            
            .title-holder-card {
                padding: 16px;
            }
            
            .title-holder-name {
                font-size: 18px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-container">
            <a href="/" class="logo">
                <div class="logo-icon">W</div>
                <span class="logo-text">WBD Í∏∞Î°ùÏã§</span>
            </a>
            <div class="header-actions">
                <div class="language-selector">
                    <button class="language-btn active" data-lang="ko">ÌïúÍµ≠Ïñ¥</button>
                    <button class="language-btn" data-lang="ja">Êó•Êú¨Ë™û</button>
                </div>
            </div>
        </div>
    </header>
    
    <nav class="nav-container">
        <div class="nav">
            <a href="record_bat_basic.html" class="nav-item">Í∏∞Î°ùÏã§</a>
            <a href="season.html" class="nav-item active">ÏãúÏ¶åÏ†ïÎ≥¥</a>
            <a href="team.html" class="nav-item">ÌåÄÏ†ïÎ≥¥</a>
            <a href="player.html" class="nav-item">ÏÑ†ÏàòÏ†ïÎ≥¥</a>
            <a href="schedule.html" class="nav-item">Í≤ΩÍ∏∞ÏùºÏ†ï</a>


        </div>
    </nav>

    <main class="main-content">
        <div class="content-container">
            <h1 class="page-title">ÏãúÏ¶å Í∏∞Î°ù</h1>
            <div class="league-selector">
                <h2>Î¶¨Í∑∏ ÏÑ†ÌÉù</h2>
                <select class="league-dropdown" id="leagueDropdown">
                    <option value="">Î¶¨Í∑∏Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                </select>
            </div>
            <div class="selected-league-info" id="selectedLeagueInfo">
                <h3>
                    <span class="league-badge" id="selectedLeagueBadge"></span>
                </h3>
            </div>
            <div class="mvp-section" id="mvpSection">
                <h3>
                    <span class="mvp-badge">ÌÉÄÏù¥ÌãÄ ÌôÄÎçî</span>
                </h3>
                <div class="title-holder-cards">
                    <!-- ÌÉÄÏù¥ÌãÄ ÌôÄÎçî Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï±ÑÏõåÏßëÎãàÎã§ -->
                </div>
            </div>
            <div class="league-record-section" id="leagueRecordSection">
                <h3>
                    <span class="record-badge">Î¶¨Í∑∏ Í∏∞Î°ù</span>
                </h3>
                <div class="record-cards">
                    <!-- Î¶¨Í∑∏ Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞Í∞Ä Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï±ÑÏõåÏßëÎãàÎã§ -->
                </div>
            </div>
            <div class="content-placeholder">
                ÏãúÏ¶å Ï†ïÎ≥¥ ÌéòÏù¥ÏßÄ ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.
            </div>
        </div>
    </main>

    <script>
        // Excel ÌååÏùºÏóêÏÑú Î¶¨Í∑∏ Ï†ïÎ≥¥Î•º ÏùΩÏñ¥Ïò§Îäî Ìï®Ïàò
        async function loadLeagueData() {
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                // 'Î¶¨Í∑∏Î∂ÑÎ•ò' ÏãúÌä∏ ÏùΩÍ∏∞
                const sheetName = 'Î¶¨Í∑∏Î∂ÑÎ•ò';
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    // Ï≤´ Î≤àÏß∏ ÌñâÏùÑ Ìó§ÎçîÎ°ú ÏÇ¨Ïö©
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);
                    
                    // "League Name" Ïª¨Îüº Ï∞æÍ∏∞
                    const leagueNameColumnIndex = headers.findIndex(header => 
                        header && header.toString().toLowerCase().includes('league name')
                    );
                    
                    // "isdef" Ïª¨Îüº Ï∞æÍ∏∞
                    const isdefColumnIndex = headers.findIndex(header => 
                        header && header.toString().toLowerCase().includes('isdef')
                    );
                    
                    if (leagueNameColumnIndex !== -1) {
                        // League Name Ïª¨Îüº ÏïÑÎûòÏùò Î¶¨Í∑∏Î™ÖÎì§ Ï∂îÏ∂ú (ÏõêÎ≥∏ ÏàúÏÑú Ïú†ÏßÄ)
                        const leagues = data.map(row => row[leagueNameColumnIndex]).filter(Boolean);
                        
                        // ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏
                        updateLeagueDropdown(leagues);
                        
                        // Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞Î•º Ï†ÑÏó≠ Î≥ÄÏàòÏóê Ï†ÄÏû• (ÏÑ†ÌÉù Ïãú ÏÇ¨Ïö©)
                        window.leagueData = { headers, data, leagueNameColumnIndex, isdefColumnIndex };
                        
                        // isdefÍ∞Ä trueÏù∏ Î¶¨Í∑∏Î•º Ï∞æÏïÑÏÑú Í∏∞Î≥∏ ÏÑ†ÌÉù
                        if (isdefColumnIndex !== -1) {
                            const defaultLeagueRow = data.find(row => 
                                row[isdefColumnIndex] && 
                                row[isdefColumnIndex].toString().toLowerCase() === 'true'
                            );
                            
                            if (defaultLeagueRow) {
                                const defaultLeague = defaultLeagueRow[leagueNameColumnIndex];
                                if (defaultLeague) {
                                    // ÎìúÎ°≠Îã§Ïö¥ÏóêÏÑú Í∏∞Î≥∏ Î¶¨Í∑∏ ÏÑ†ÌÉù
                                    const dropdown = document.getElementById('leagueDropdown');
                                    dropdown.value = defaultLeague;
                                    
                                    // Í∏∞Î≥∏ Î¶¨Í∑∏ Ï†ïÎ≥¥ ÌëúÏãú
                                    displayLeagueInfo(defaultLeague);
                                    document.getElementById('selectedLeagueInfo').classList.add('show');
                                    
                                    // Í∏∞Î≥∏ Î¶¨Í∑∏Ïùò ÏàòÌõàÏÑ†ÏàòÏôÄ Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                                    loadMVPData(defaultLeague);
                                    loadLeagueRecordData(defaultLeague);
                                }
                            }
                        }
                        
                        console.log('League Name Ïª¨Îüº Ïù∏Îç±Ïä§:', leagueNameColumnIndex);
                        console.log('isdef Ïª¨Îüº Ïù∏Îç±Ïä§:', isdefColumnIndex);
                        console.log('Î°úÎìúÎêú Î¶¨Í∑∏:', leagues);
                        console.log('Ï†ÑÏ≤¥ Î¶¨Í∑∏ Îç∞Ïù¥ÌÑ∞:', window.leagueData);
                    } else {
                        console.error('League Name Ïª¨ÎüºÏùÑ Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                        updateLeagueDropdown([]);
                    }
                } else {
                    console.error('Î¶¨Í∑∏Î∂ÑÎ•ò ÏãúÌä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.');
                    updateLeagueDropdown([]);
                }
            } catch (error) {
                console.error('Excel ÌååÏùºÏùÑ ÏùΩÎäî Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                updateLeagueDropdown([]);
            }
        }

        // Î¶¨Í∑∏ ÎìúÎ°≠Îã§Ïö¥ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
        function updateLeagueDropdown(leagues) {
            const dropdown = document.getElementById('leagueDropdown');
            dropdown.innerHTML = '<option value="">Î¶¨Í∑∏Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>';
            
            leagues.forEach(league => {
                const option = document.createElement('option');
                option.value = league;
                option.textContent = league;
                dropdown.appendChild(option);
            });

            // ÎìúÎ°≠Îã§Ïö¥ Î≥ÄÍ≤Ω Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Ï∂îÍ∞Ä
            dropdown.addEventListener('change', handleLeagueSelection);
        }

        // Î¶¨Í∑∏ ÏÑ†ÌÉù Ï≤òÎ¶¨ Ìï®Ïàò
        function handleLeagueSelection(event) {
            const selectedLeague = event.target.value;
            const leagueInfo = document.getElementById('selectedLeagueInfo');
            
            if (!selectedLeague) {
                leagueInfo.classList.remove('show');
                // Î¶¨Í∑∏Í∞Ä ÏÑ†ÌÉùÎêòÏßÄ ÏïäÏïòÏùÑ ÎïåÎäî ÏàòÌõàÏÑ†ÏàòÏôÄ Í∏∞Î°ù ÏÑπÏÖòÎèÑ Ïà®ÍπÄ
                document.getElementById('mvpSection').classList.remove('show');
                document.getElementById('leagueRecordSection').classList.remove('show');
                return;
            }

            // ÏÑ†ÌÉùÎêú Î¶¨Í∑∏ Ï†ïÎ≥¥ ÌëúÏãú
            displayLeagueInfo(selectedLeague);
            leagueInfo.classList.add('show');
            
            // ÏÑ†ÌÉùÎêú Î¶¨Í∑∏Ïùò ÏàòÌõàÏÑ†ÏàòÏôÄ Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            loadMVPData(selectedLeague);
            loadLeagueRecordData(selectedLeague);
        }

        // Î¶¨Í∑∏ Ï†ïÎ≥¥ ÌëúÏãú Ìï®Ïàò
        function displayLeagueInfo(leagueName) {
            // Î¶¨Í∑∏ Î∞∞ÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
            const badge = document.getElementById('selectedLeagueBadge');
            badge.textContent = leagueName;
            
            // Excel Îç∞Ïù¥ÌÑ∞ÏóêÏÑú Ìï¥Îãπ Î¶¨Í∑∏ Ï†ïÎ≥¥ Ï∞æÍ∏∞
            if (window.leagueData && window.leagueData.data) {
                const leagueRow = window.leagueData.data.find(row => row[window.leagueData.leagueNameColumnIndex] === leagueName);
                if (leagueRow) {
                    // Ìó§ÎçîÏôÄ Îç∞Ïù¥ÌÑ∞ Îß§Ïπ≠ÌïòÏó¨ Ï†ïÎ≥¥ ÌëúÏãú
                    const headers = window.leagueData.headers;
                    const data = leagueRow;
                    
                    // Í∞Å Ïª¨ÎüºÏùò Ï†ïÎ≥¥Î•º ÌëúÏãú (Ìó§ÎçîÍ∞Ä ÏûàÎäî Í≤ΩÏö∞)
                    if (headers && headers.length > 1) {
                        for (let i = 1; i < Math.min(headers.length, 5); i++) {
                            const header = headers[i];
                            const value = data[i] || 'Ï†ïÎ≥¥ ÏóÜÏùå';
                            
                            // Ìï¥ÎãπÌïòÎäî detail-value ÏöîÏÜå Ï∞æÏïÑÏÑú ÏóÖÎç∞Ïù¥Ìä∏
                            const detailElements = document.querySelectorAll('.detail-value');
                            if (detailElements[i]) {
                                detailElements[i].textContent = value;
                            }
                        }
                    }
                }
            }
        }

        // MVP Îç∞Ïù¥ÌÑ∞ Î°úÎìú Î∞è ÌëúÏãú Ìï®Ïàò
        async function loadMVPData(leagueName) {
            if (!leagueName) return;
            
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                const sheetName = `${leagueName} ÏàòÌõà`; // ÏÑ†ÌÉùÎêú Î¶¨Í∑∏Î™Ö + "ÏàòÌõà"
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);

                    // ÌÉÄÏù¥ÌãÄ ÌôÄÎçîÍ∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏
                    if (data.length > 0 && data.some(row => row.some(cell => cell))) {
                        const titleHolderCards = document.querySelector('#mvpSection .title-holder-cards');
                        titleHolderCards.innerHTML = ''; // Ïπ¥Îìú Ïª®ÌÖåÏù¥ÎÑà ÎÇ¥Ïö© Ï¥àÍ∏∞Ìôî

                        let mvpFound = false;
                        const outstandingCards = [];
                        const regularCards = [];

                        // Î∂ÄÎ¨∏Í≥º Ïù¥Î¶Ñ Íµ¨Ï°∞Î°ú Îç∞Ïù¥ÌÑ∞ Ï≤òÎ¶¨
                        data.forEach((row, rowIndex) => {
                            if (row && row.length >= 2 && (row[0] || row[1])) { // Î∂ÄÎ¨∏Í≥º Ïù¥Î¶ÑÏù¥ ÏûàÎäî ÌñâÎßå
                                const category = row[0] || '';
                                const name = row[1] || 'Ï†ïÎ≥¥ ÏóÜÏùå';
                                
                                // MVP Î∂ÄÎ¨∏ ÌôïÏù∏ (ÎåÄÏÜåÎ¨∏Ïûê Íµ¨Î∂Ñ ÏóÜÏù¥)
                                if (category.toString().toLowerCase().includes('mvp')) {
                                    
                                    // MVP ÌäπÎ≥Ñ Ïπ¥Îìú ÏÉùÏÑ±
                                    const mvpCard = document.createElement('div');
                                    mvpCard.classList.add('mvp-special-card');
                                    mvpCard.innerHTML = `
                                        <div class="mvp-special-icon">üëë</div>
                                        <div class="mvp-special-label">MVP</div>
                                        <div class="mvp-special-name">${name}</div>
                                    `;
                                    titleHolderCards.appendChild(mvpCard);
                                    mvpFound = true;
                                } else if (category.toString().toLowerCase().includes('ÏµúÏö∞Ïàò')) {
                                    // ÏµúÏö∞Ïàò Î∂ÄÎ¨∏ Ïπ¥Îìú Ï†ïÎ≥¥ Ï†ÄÏû•
                                    outstandingCards.push({ category, name });
                                } else {
                                    // ÏùºÎ∞ò ÌÉÄÏù¥ÌãÄ ÌôÄÎçî Ïπ¥Îìú Ï†ïÎ≥¥ Ï†ÄÏû•
                                    regularCards.push({ category, name });
                                }
                            }
                        });

                        // ÏµúÏö∞Ïàò Î∂ÄÎ¨∏ Ïπ¥ÎìúÎì§ÏùÑ MVP ÏïÑÎûòÏóê ÌëúÏãú
                        if (outstandingCards.length > 0) {
                            outstandingCards.forEach(({ category, name }) => {
                                const card = document.createElement('div');
                                card.classList.add('outstanding-card');
                                
                                // Î∂ÄÎ¨∏Ïóê Îî∞Î•∏ ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                                let iconText = '‚≠ê';
                                
                                if (category.toString().toLowerCase().includes('ÌÉÄ')) {
                                    iconText = '‚öæ';
                                } else if (category.toString().toLowerCase().includes('Ìà¨')) {
                                    iconText = 'üéØ';
                                }

                                card.innerHTML = `
                                    <div class="outstanding-icon">${iconText}</div>
                                    <div class="outstanding-label">${category}</div>
                                    <div class="outstanding-name">${name}</div>
                                `;
                                
                                titleHolderCards.appendChild(card);
                            });
                        }

                        // ÏùºÎ∞ò ÌÉÄÏù¥ÌãÄ ÌôÄÎçî Ïπ¥ÎìúÎì§ÏùÑ Í∑∏Î¶¨ÎìúÎ°ú ÌëúÏãú
                        if (regularCards.length > 0) {
                            const regularCardsContainer = document.createElement('div');
                            regularCardsContainer.classList.add('regular-title-holder-cards');
                            
                            regularCards.forEach(({ category, name }) => {
                                const card = document.createElement('div');
                                card.classList.add('title-holder-card');
                                
                                // Î∂ÄÎ¨∏Ïóê Îî∞Î•∏ ÏïÑÏù¥ÏΩò ÏÑ§Ï†ï
                                let iconText = 'üèÜ';
                                
                                if (category.toString().toLowerCase().includes('ÌÉÄ')) {
                                    iconText = '‚öæ';
                                } else if (category.toString().toLowerCase().includes('Ìà¨')) {
                                    iconText = 'üéØ';
                                } else if (category.toString().toLowerCase().includes('ÌåÄ')) {
                                    iconText = 'üèÖ';
                                } else if (category.toString().toLowerCase().includes('ÏàòÎπÑ')) {
                                    iconText = 'üõ°Ô∏è';
                                } else if (category.toString().toLowerCase().includes('Ï£ºÎ£®')) {
                                    iconText = 'üèÉ';
                                }

                                card.innerHTML = `
                                    <div class="title-holder-icon">${iconText}</div>
                                    <div class="title-holder-category">${category}</div>
                                    <div class="title-holder-name">${name}</div>
                                `;
                                
                                regularCardsContainer.appendChild(card);
                            });
                            
                            titleHolderCards.appendChild(regularCardsContainer);
                        }

                        document.getElementById('mvpSection').classList.add('show');
                    } else {
                        // ÌÉÄÏù¥ÌãÄ ÌôÄÎçîÍ∞Ä ÏóÜÏúºÎ©¥ ÌëúÏãúÌïòÏßÄ ÏïäÏùå
                        document.getElementById('mvpSection').classList.remove('show');
                    }
                } else {
                    console.error(`${sheetName} ÏãúÌä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.`);
                    document.getElementById('mvpSection').classList.remove('show');
                }
            } catch (error) {
                console.error('MVP Îç∞Ïù¥ÌÑ∞Î•º ÏùΩÎäî Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                document.getElementById('mvpSection').classList.remove('show');
            }
        }

        // Î¶¨Í∑∏ Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞ Î°úÎìú Î∞è ÌëúÏãú Ìï®Ïàò
        async function loadLeagueRecordData(leagueName) {
            if (!leagueName) return;
            
            try {
                const response = await fetch('Data/League_Team.xlsx');
                const arrayBuffer = await response.arrayBuffer();
                const workbook = XLSX.read(arrayBuffer, { type: 'array' });
                
                const sheetName = `${leagueName} Í∏∞Î°ù`; // ÏÑ†ÌÉùÎêú Î¶¨Í∑∏Î™Ö + "Í∏∞Î°ù"
                if (workbook.SheetNames.includes(sheetName)) {
                    const worksheet = workbook.Sheets[sheetName];
                    const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                    
                    const headers = jsonData[0];
                    const data = jsonData.slice(1);

                    const recordCardsContainer = document.querySelector('#leagueRecordSection .record-cards');
                    recordCardsContainer.innerHTML = ''; // Ïπ¥Îìú Ïª®ÌÖåÏù¥ÎÑà ÎÇ¥Ïö© Ï¥àÍ∏∞Ìôî

                    if (data.length > 0) {
                        data.forEach((row, index) => {
                            if (row.some(cell => cell)) { // Îπà ÌñâÏù¥ ÏïÑÎãå Í≤ΩÏö∞Îßå
                                const recordCard = document.createElement('div');
                                recordCard.classList.add('record-card');
                                
                                // Íµ¨Î∂Ñ Ïª¨Îüº ÌôïÏù∏ (4Î≤àÏß∏ Ïª¨ÎüºÏù¥ Íµ¨Î∂ÑÏù¥ÎùºÍ≥† Í∞ÄÏ†ï)
                                const category = row[4] || '';
                                let categoryClass = '';
                                
                                if (category.toString().toLowerCase().includes('Ìà¨')) {
                                    categoryClass = 'pitcher';
                                } else if (category.toString().toLowerCase().includes('ÌÉÄ')) {
                                    categoryClass = 'batter';
                                } else if (category.toString().toLowerCase().includes('ÌåÄ')) {
                                    categoryClass = 'team';
                                }
                                
                                if (categoryClass) {
                                    recordCard.classList.add(categoryClass);
                                }
                                
                                recordCard.innerHTML = `
                                    <div class="record-title">${row[0] || 'N/A'}</div>
                                    <div class="record-details">
                                        <div class="date-info">${row[1] || 'N/A'}</div>
                                        <div class="nickname">${row[2] || 'N/A'}</div>
                                        <div class="note-info">${row[3] || 'N/A'}</div>
                                    </div>
                                `;
                                recordCardsContainer.appendChild(recordCard);
                            }
                        });
                        
                        document.getElementById('leagueRecordSection').classList.add('show');
                    } else {
                        document.getElementById('leagueRecordSection').classList.remove('show');
                    }
                } else {
                    console.error(`${sheetName} ÏãúÌä∏Î•º Ï∞æÏùÑ Ïàò ÏóÜÏäµÎãàÎã§.`);
                    document.getElementById('leagueRecordSection').classList.remove('show');
                }
            } catch (error) {
                console.error('Î¶¨Í∑∏ Í∏∞Î°ù Îç∞Ïù¥ÌÑ∞Î•º ÏùΩÎäî Ï§ë Ïò§Î•ò Î∞úÏÉù:', error);
                document.getElementById('leagueRecordSection').classList.remove('show');
            }
        }

        // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Í∏∞Îä•
        document.addEventListener('DOMContentLoaded', function() {
            // Í∏∞Ï°¥ Ìï®Ïàò Ìò∏Ï∂ú
            loadLeagueData();
            
            // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Î≤ÑÌäº Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà
            const languageBtns = document.querySelectorAll('.language-btn');
            
            languageBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    const selectedLang = this.getAttribute('data-lang');
                    
                    // ÌôúÏÑ± Î≤ÑÌäº ÏÉÅÌÉú Î≥ÄÍ≤Ω
                    languageBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Ï≤òÎ¶¨
                    changeLanguage(selectedLang);
                });
            });
            
            // Ï†ÄÏû•Îêú Ïñ∏Ïñ¥ ÏÑ§Ï†ï Î≥µÏõê
            const savedLang = localStorage.getItem('selectedLanguage') || 'ko';
            const languageBtn = document.querySelector(`[data-lang="${savedLang}"]`);
            if (languageBtn) {
                languageBtn.click();
            }
        });

        // Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Ìï®Ïàò
        function changeLanguage(lang) {
            const translations = {
                ko: {
                    title: 'ÏãúÏ¶å Ï†ïÎ≥¥ - WBD Í∏∞Î°ùÏã§',
                    logoText: 'WBD Í∏∞Î°ùÏã§',
                    recordRoom: 'Í∏∞Î°ùÏã§',
                    seasonInfo: 'ÏãúÏ¶åÏ†ïÎ≥¥',
                    teamInfo: 'ÌåÄÏ†ïÎ≥¥',
                    playerInfo: 'ÏÑ†ÏàòÏ†ïÎ≥¥',
                    schedule: 'Í≤ΩÍ∏∞ÏùºÏ†ï',
                    pageTitle: 'ÏãúÏ¶å Í∏∞Î°ù',
                    leagueSelector: 'Î¶¨Í∑∏ ÏÑ†ÌÉù',
                    leagueSelectPlaceholder: 'Î¶¨Í∑∏Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî',
                    mvpSection: 'ÌÉÄÏù¥ÌãÄ ÌôÄÎçî',
                    leagueRecordSection: 'Î¶¨Í∑∏ Í∏∞Î°ù',
                    category: 'Î∂ÄÎ¨∏',
                    name: 'Ïù¥Î¶Ñ',
                    contentPlaceholder: 'ÏãúÏ¶å Ï†ïÎ≥¥ ÌéòÏù¥ÏßÄ ÎÇ¥Ïö©Ïù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§.'
                },
                ja: {
                    title: '„Ç∑„Éº„Ç∫„É≥ÊÉÖÂ†± - WBD Ë®òÈå≤ÂÆ§',
                    logoText: 'WBD Ë®òÈå≤ÂÆ§',
                    recordRoom: 'Ë®òÈå≤ÂÆ§',
                    seasonInfo: '„Ç∑„Éº„Ç∫„É≥ÊÉÖÂ†±',
                    teamInfo: '„ÉÅ„Éº„É†ÊÉÖÂ†±',
                    playerInfo: 'ÈÅ∏ÊâãÊÉÖÂ†±',
                    schedule: 'Ë©¶ÂêàÊó•Á®ã',
                    pageTitle: '„Ç∑„Éº„Ç∫„É≥Ë®òÈå≤',
                    leagueSelector: '„É™„Éº„Ç∞ÈÅ∏Êäû',
                    leagueSelectPlaceholder: '„É™„Éº„Ç∞„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ',
                    mvpSection: '„Çø„Ç§„Éà„É´„Éõ„É´„ÉÄ„Éº',
                    leagueRecordSection: '„É™„Éº„Ç∞Ë®òÈå≤',
                    category: 'ÈÉ®ÈñÄ',
                    name: 'ÂêçÂâç',
                    contentPlaceholder: '„Ç∑„Éº„Ç∫„É≥ÊÉÖÂ†±„Éö„Éº„Ç∏„ÅÆÂÜÖÂÆπ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô„ÄÇ'
                }
            };

            // Ï†úÎ™© Î≥ÄÍ≤Ω
            document.title = translations[lang].title;
            document.querySelector('.logo-text').textContent = translations[lang].logoText;

            // ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò Î©îÎâ¥ Î≥ÄÍ≤Ω
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach((item, index) => {
                if (index === 0) item.textContent = translations[lang].recordRoom;
                else if (index === 1) item.textContent = translations[lang].seasonInfo;
                else if (index === 2) item.textContent = translations[lang].teamInfo;
                else if (index === 3) item.textContent = translations[lang].playerInfo;
                else if (index === 4) item.textContent = translations[lang].schedule;
            });

            // ÌéòÏù¥ÏßÄ Ï†úÎ™© Î≥ÄÍ≤Ω
            document.querySelector('.page-title').textContent = translations[lang].pageTitle;

            // Î¶¨Í∑∏ ÏÑ†ÌÉù ÏÑπÏÖò Î≥ÄÍ≤Ω
            document.querySelector('.league-selector h2').textContent = translations[lang].leagueSelector;
            document.querySelector('#leagueDropdown option[value=""]').textContent = translations[lang].leagueSelectPlaceholder;

            // MVP ÏÑπÏÖò Î≥ÄÍ≤Ω
            document.querySelector('.mvp-badge').textContent = translations[lang].mvpSection;

            // Î¶¨Í∑∏ Í∏∞Î°ù ÏÑπÏÖò Î≥ÄÍ≤Ω
            document.querySelector('.record-badge').textContent = translations[lang].leagueRecordSection;

            // ÌÉÄÏù¥ÌãÄ ÌôÄÎçî Ïπ¥Îìú ÏóÖÎç∞Ïù¥Ìä∏ (Ïñ∏Ïñ¥ Î≥ÄÍ≤Ω Ïãú ÌïÑÏöîÏãú Íµ¨ÌòÑ)

            // ÏΩòÌÖêÏ∏† ÌîåÎ†àÏù¥Ïä§ÌôÄÎçî Î≥ÄÍ≤Ω
            const contentPlaceholder = document.querySelector('.content-placeholder');
            if (contentPlaceholder) {
                contentPlaceholder.textContent = translations[lang].contentPlaceholder;
            }

            // Î°úÏª¨ Ïä§ÌÜ†Î¶¨ÏßÄÏóê Ïñ∏Ïñ¥ ÏÑ§Ï†ï Ï†ÄÏû•
            localStorage.setItem('selectedLanguage', lang);
        }
    </script>
</body>
</html>